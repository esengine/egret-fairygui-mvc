window.mvc={},window.__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();var BaseView=function(t){function n(){var n=t.call(this)||this;return n.viewLayer=viewLayer.pop,n._isDispose=!1,n}return __extends(n,t),Object.defineProperty(n.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),n.prototype.init=function(){this._destoryChildren=!0},n.prototype.resize=function(){this._fuiView&&this._isShow&&(this._fuiView.width=LayerManager.getInstance().stage.stageWidth,this._fuiView.height=LayerManager.getInstance().stage.stageHeight)},n.prototype.baseShow=function(t){this._isShow=!0,this._showData=t,egret.callLater(this.resize,this)},n.prototype.show=function(){},n.prototype.close=function(){this._isShow=!1,ViewManager.getInstance().closeView(this)},n.prototype.baseRefresh=function(t){this._showData=t},n.prototype.refresh=function(t){this._showData=t},n.prototype.destroy=function(){if(this._isDispose=!0,this.parent&&this.parent.removeChild(this),this._destoryChildren){for(this._fuiView=null;this.numChildren>0;)this.removeChildAt(0);this._destoryChildren=!1}},n}(egret.DisplayObjectContainer),EventManager=function(){function t(){this._dict={},this._eventList=[]}return t.getInstance=function(){return this._single||(this._single=new t),this._single},t.prototype.addListener=function(t,n,e){var r=this._dict[t];null==r&&(r=[],this._dict[t]=r);var i,o=r.length;for(i=0;i<o;i++)if(r[i][0]==n&&r[i][1]==e)return;r.push([n,e])},t.prototype.removeListener=function(t,n,e){var r=this._dict[t];if(null!=r){var i,o=Array.length;for(i=0;i<o;i++)if(r[i][0]==n&&r[i][1]==e){r.splice(i,1),i--;break}0==r.length&&(delete this._dict[t],this._dict[t]=null)}},t.prototype.dispatch=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if(null!=this._dict[t]){var r=new EventVo;r.type=t,r.param=n,this.dealMsg(r)}},t.prototype.dealMsg=function(t){var n=this._dict[t.type];if(n&&n.length>0)for(var e=0,r=n.length,i=null;e<r;)(i=n[e])[0].apply(i[1],t.param),n.length!=r&&(r=n.length,e--),e++;t.dispose()},t}(),EventVo=function(){function t(){}return t.prototype.dispose=function(){this.type=null,this.param=null},t}();String.prototype.trimStart=function(t){return function(t,n){var e;return e=n?new RegExp("^"+n):new RegExp(/^\s*/),t.replace(e,"")}(this,t)},String.prototype.trimEnd=function(t){return function(t,n){var e;return e=n?new RegExp(n+"$"):new RegExp(/\s*$/),t.replace(e,"")}(this,t)},Array.prototype.findIndex=function(t){return function(t,n){for(var e=0,r=t.length;e<r;e++)if(n.call(arguments[2],t[e],e,t))return e;return-1}(this,t)},Array.prototype.any=function(t){return function(t,n){return t.findIndex(n)>-1}(this,t)},Array.prototype.firstOrDefault=function(t){return function(t,n){var e=t.findIndex(n);return-1==e?null:t[e]}(this,t)},Array.prototype.find=function(t){return function(t,n){return t.firstOrDefault(n)}(this,t)},Array.prototype.where=function(t){return function(t,n){if("function"==typeof t.reduce)return t.reduce(function(e,r,i){return n.call(arguments[2],r,i,t)&&e.push(r),e},[]);for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];n.call(arguments[2],o,r,t)&&e.push(o)}return e}(this,t)},Array.prototype.count=function(t){return function(t,n){return t.where(n).length}(this,t)},Array.prototype.findAll=function(t){return function(t,n){return t.where(n)}(this,t)},Array.prototype.contains=function(t){return function(t,n){for(var e=0,r=t.length;e<r;e++)if(JSON.stringify(t[e])==JSON.stringify(n))return!0;return!1}(this,t)},Array.prototype.removeAll=function(t){!function(t,n){var e;do{(e=t.findIndex(n))>=0&&t.splice(e,1)}while(e>=0)}(this,t)},Array.prototype.remove=function(t){return function(t,n){var e=t.findIndex(function(t){return t===n});return e>=0&&(t.splice(e,1),!0)}(this,t)},Array.prototype.removeAt=function(t){return function(t,n){t.splice(n,1)}(this,t)},Array.prototype.removeRange=function(t,n){return function(t,n,e){t.splice(n,e)}(this,t,n)},Array.prototype.select=function(t){return function(t,n){if("function"==typeof t.reduce)return t.reduce(function(e,r,i){return e.push(n.call(arguments[2],r,i,t)),e},[]);for(var e=[],r=0,i=t.length;r<i;r++)e.push(n.call(arguments[2],t[r],r,t));return e}(this,t)},Array.prototype.orderBy=function(t,n){return function(t,n,e){return t.sort(function(t,r){var i=n(t),o=n(r);return e?e(i,o):i>o?1:-1}),t}(this,t,n)},Array.prototype.orderByDescending=function(t,n){return function(t,n,e){return t.sort(function(t,r){var i=n(t),o=n(r);return e?-e(i,o):i<o?1:-1}),t}(this,t,n)},Array.prototype.groupBy=function(t){return function(t,n){if("function"==typeof t.reduce){var e=[];return t.reduce(function(r,i,o){var u=JSON.stringify(n.call(arguments[1],i,o,t)),s=e.findIndex(function(t){return t===u});return s<0&&(s=e.push(u)-1),r[s]||(r[s]=[]),r[s].push(i),r},[])}for(var r=[],i=[],o=function(e,o){var s=JSON.stringify(n.call(u[1],t[e],e,t)),c=i.findIndex(function(t){return t===s});c<0&&(c=i.push(s)-1),r[c]||(r[c]=[]),r[c].push(t[e])},u=arguments,s=0,c=t.length;s<c;s++)o(s);return r}(this,t)},Array.prototype.sum=function(t){return function(t,n){for(var e,r=0,i=t.length;r<i;r++)0==r?e=n?n.call(arguments[2],t[r],r,t):t[r]:e+=n?n.call(arguments[2],t[r],r,t):t[r];return e}(this,t)};var viewLayer,FguiUtils=function(){function t(){}return t.load=function(t){return new Promise(function(n,e){fairygui.UIPackage.getByName(t)&&n(),RES.loadGroup(t,0).then(function(){fairygui.UIPackage.addPackage(t),t[t+"Binder"].bindAll(),n()}).catch(function(t){console.error("loadfgui error:"+t),e()})})},t}();!function(t){t[t.pop=0]="pop"}(viewLayer||(viewLayer={}));var LayerManager=function(){function t(){}return t.getInstance=function(){return this._single&&(this._single=new t),this._single},Object.defineProperty(t.prototype,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this._stage=t,this.popLayer=new egret.DisplayObjectContainer,this._stage.addChild(this.popLayer)},t.prototype.addLayerToView=function(t){this[viewLayer[t.viewLayer]+"Layer"].addChild(t)},t}(),ViewManager=function(){function t(){this._openDic=[],this._skipCloseDic=[],this._layerManager=LayerManager.getInstance()}return t.getInstance=function(){return this._single||(this._single=new t),this._single},t.prototype.openView=function(t,n){var e=this;return new Promise(function(r,i){var o=e.getView(t);o||(o=new t),e.isOpenView(t)?o.refresh(n):(e._openDic.push(o),FguiUtils.load(o.name).then(function(){o.init(),o.baseShow(n),o.show(),e._layerManager.addLayerToView(o),r()}).catch(function(){e._openDic.remove(o),o.destroy(),o=null,i()}))})},t.prototype.closeView=function(t){var n=this._openDic.firstOrDefault(function(n){return n==t});n&&(this._openDic.remove(n),n.destroy(),n=null)},t.prototype.closeAll=function(){for(var t=0;t<this._openDic.length;t++){for(var n=this._openDic[t],e=!0,r=0;r<this._skipCloseDic.length;r++)n==this.getView(this._skipCloseDic[r])&&(e=!1);e&&(this.closeView(n),t--)}},t.prototype.closeViewByCls=function(t){var n=this._openDic.firstOrDefault(function(n){return n instanceof t});n&&(this._openDic.remove(n),n.destroy(),n=null)},t.prototype.getView=function(t){return this._openDic.firstOrDefault(function(n){return n instanceof t})},t.prototype.isOpenView=function(t){return-1!=this._openDic.findIndex(function(n){return n instanceof t})},t}();